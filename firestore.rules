rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    // Universal Admin Check - ONLY gauravpatil9262@gmail.com
    function isAdmin() {
      return request.auth != null && request.auth.token.email == 'gauravpatil9262@gmail.com';
    }

    match /{document=**} {
      // By default, only the admin email can read/write everything.
      // Other collections may have specific rules below if public access is needed (e.g., token validation).
      allow read, write: if isAdmin();
    }

    match /tokenInvites/{inviteId} {
      // Allow public read only if they know the exact tokenHash (used in claim route if done client-side, 
      // though we do it server-side so we could tighten this to none).
      // Since claim route is an API, we can keep this Admin-only for maximum security.
      allow read, write: if isAdmin();
    }
  }
}
